{"metadata":{"name":"Web Archives 2015, Demo","user_save_timestamp":"1969-12-31T19:00:00.000Z","auto_save_timestamp":"1969-12-31T19:00:00.000Z","language_info":{"name":"scala","file_extension":"scala","codemirror_mode":"text/x-scala"},"trusted":true,"customLocalRepo":null,"customRepos":null,"customDeps":null,"customImports":null,"customArgs":null,"customSparkConf":null},"cells":[{"metadata":{},"cell_type":"markdown","source":"# Web Archives 2015 Demo\n\nThis is a notebook that we can update to generate domain-level counts, plain text, and link analysis. It can be shared and distributed between researchers."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":true},"cell_type":"code","source":":cp /Users/ianmilligan1/dropbox/warcbase/target/warcbase-0.1.0-SNAPSHOT-fatjar.jar","outputs":[{"name":"stdout","output_type":"stream","text":"warning: there were 4 feature warning(s); re-run with -feature for details\nglobalScope.jars: Array[String] = [Ljava.lang.String;@3626dbc\nres4: List[String] = List(/Users/ianmilligan1/dropbox/warcbase/target/warcbase-0.1.0-SNAPSHOT-fatjar.jar, file:/Users/ianmilligan1/Dropbox/spark-notebook-0.6.1-scala-2.10.4-spark-1.3.0-hadoop-2.6.0/, file:/Users/ianmilligan1/dropbox/spark-notebook-0.6.1-scala-2.10.4-spark-1.3.0-hadoop-2.6.0/lib/common.common-0.6.1-scala-2.10.4-spark-1.3.0-hadoop-2.6.0.jar)\n"},{"metadata":{},"data":{"text/html":"<div class=\"container-fluid\"><div><div class=\"col-md-12\"><div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon106ce560e71883720d31381002e62ab6&quot;,&quot;dataInit&quot;:[{&quot;string value&quot;:&quot;/Users/ianmilligan1/dropbox/warcbase/target/warcbase-0.1.0-SNAPSHOT-fatjar.jar&quot;},{&quot;string value&quot;:&quot;file:/Users/ianmilligan1/Dropbox/spark-notebook-0.6.1-scala-2.10.4-spark-1.3.0-hadoop-2.6.0/&quot;},{&quot;string value&quot;:&quot;file:/Users/ianmilligan1/dropbox/spark-notebook-0.6.1-scala-2.10.4-spark-1.3.0-hadoop-2.6.0/lib/common.common-0.6.1-scala-2.10.4-spark-1.3.0-hadoop-2.6.0.jar&quot;}],&quot;genId&quot;:&quot;1045712389&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"string value\"],\"nrow\":3,\"shown\":3,\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    </div></div></div></div>"},"output_type":"execute_result","execution_count":1}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"import org.warcbase.spark.matchbox._ \nimport org.warcbase.spark.rdd.RecordRDD._ ","outputs":[{"name":"stdout","output_type":"stream","text":"import org.warcbase.spark.matchbox._\nimport org.warcbase.spark.rdd.RecordRDD._\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":2}]},{"metadata":{},"cell_type":"markdown","source":"This command extracts the top-level domains found within a directory of ARCs/WARCs, or an individual WARC/ARC file."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val r = \nRecordLoader.loadArc(\"/Users/ianmilligan1/Dropbox/warcs-workshop/227-20051004191331-00000-crawling015.archive.org.arc.gz\", \nsc) \n.keepValidPages() \n.map(r => ExtractTopLevelDomain(r.getUrl)) \n.countItems() \n.take(10) ","outputs":[{"name":"stdout","output_type":"stream","text":"r: Array[(String, Int)] = Array((cpcml.ca,272), (partimarijuana.org,216), (communist-party.ca,157), (westernblockparty.com,145), (liberal.ca,109), (worldsocialism.org,106), (agoracosmopolite.com,104), (wegovern.ca,75), (www.conservative.ca,71), (canadianactionparty.ca,59))\n"},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon2626a060bd7b9d7daa1b128042d158db&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;cpcml.ca&quot;,&quot;_2&quot;:272},{&quot;_1&quot;:&quot;partimarijuana.org&quot;,&quot;_2&quot;:216},{&quot;_1&quot;:&quot;communist-party.ca&quot;,&quot;_2&quot;:157},{&quot;_1&quot;:&quot;westernblockparty.com&quot;,&quot;_2&quot;:145},{&quot;_1&quot;:&quot;liberal.ca&quot;,&quot;_2&quot;:109},{&quot;_1&quot;:&quot;worldsocialism.org&quot;,&quot;_2&quot;:106},{&quot;_1&quot;:&quot;agoracosmopolite.com&quot;,&quot;_2&quot;:104},{&quot;_1&quot;:&quot;wegovern.ca&quot;,&quot;_2&quot;:75},{&quot;_1&quot;:&quot;www.conservative.ca&quot;,&quot;_2&quot;:71},{&quot;_1&quot;:&quot;canadianactionparty.ca&quot;,&quot;_2&quot;:59}],&quot;genId&quot;:&quot;2136979155&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n        <ul class=\"nav nav-tabs\" id=\"ul2136979155\"><li>\n              <a href=\"#tab2136979155-0\"><i class=\"fa fa-table\"/></a>\n            </li><li>\n              <a href=\"#tab2136979155-1\"><i class=\"fa fa-bar-chart\"/></a>\n            </li><li>\n              <a href=\"#tab2136979155-2\"><i class=\"fa fa-pie-chart\"/></a>\n            </li></ul>\n\n        <div class=\"tab-content\" id=\"tab2136979155\"><div class=\"tab-pane\" id=\"tab2136979155-0\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anondd8f7994495e2be99d46f77497605157&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;cpcml.ca&quot;,&quot;_2&quot;:272},{&quot;_1&quot;:&quot;partimarijuana.org&quot;,&quot;_2&quot;:216},{&quot;_1&quot;:&quot;communist-party.ca&quot;,&quot;_2&quot;:157},{&quot;_1&quot;:&quot;westernblockparty.com&quot;,&quot;_2&quot;:145},{&quot;_1&quot;:&quot;liberal.ca&quot;,&quot;_2&quot;:109},{&quot;_1&quot;:&quot;worldsocialism.org&quot;,&quot;_2&quot;:106},{&quot;_1&quot;:&quot;agoracosmopolite.com&quot;,&quot;_2&quot;:104},{&quot;_1&quot;:&quot;wegovern.ca&quot;,&quot;_2&quot;:75},{&quot;_1&quot;:&quot;www.conservative.ca&quot;,&quot;_2&quot;:71},{&quot;_1&quot;:&quot;canadianactionparty.ca&quot;,&quot;_2&quot;:59}],&quot;genId&quot;:&quot;655796983&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\"],\"nrow\":10,\"shown\":10,\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    </div>\n            </div><div class=\"tab-pane\" id=\"tab2136979155-1\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon45b9a25bcf7f9619e2581f1b87c1bba0&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;cpcml.ca&quot;,&quot;_2&quot;:272},{&quot;_1&quot;:&quot;partimarijuana.org&quot;,&quot;_2&quot;:216},{&quot;_1&quot;:&quot;communist-party.ca&quot;,&quot;_2&quot;:157},{&quot;_1&quot;:&quot;westernblockparty.com&quot;,&quot;_2&quot;:145},{&quot;_1&quot;:&quot;liberal.ca&quot;,&quot;_2&quot;:109},{&quot;_1&quot;:&quot;worldsocialism.org&quot;,&quot;_2&quot;:106},{&quot;_1&quot;:&quot;agoracosmopolite.com&quot;,&quot;_2&quot;:104},{&quot;_1&quot;:&quot;wegovern.ca&quot;,&quot;_2&quot;:75},{&quot;_1&quot;:&quot;www.conservative.ca&quot;,&quot;_2&quot;:71},{&quot;_1&quot;:&quot;canadianactionparty.ca&quot;,&quot;_2&quot;:59}],&quot;genId&quot;:&quot;628774173&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"_1\",\"y\":\"_2\",\"nrow\":10,\"shown\":10,\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    </div>\n            </div><div class=\"tab-pane\" id=\"tab2136979155-2\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonb5a29ebfdcd2ac23134740f975889cec&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;cpcml.ca&quot;,&quot;_2&quot;:272},{&quot;_1&quot;:&quot;partimarijuana.org&quot;,&quot;_2&quot;:216},{&quot;_1&quot;:&quot;communist-party.ca&quot;,&quot;_2&quot;:157},{&quot;_1&quot;:&quot;westernblockparty.com&quot;,&quot;_2&quot;:145},{&quot;_1&quot;:&quot;liberal.ca&quot;,&quot;_2&quot;:109},{&quot;_1&quot;:&quot;worldsocialism.org&quot;,&quot;_2&quot;:106},{&quot;_1&quot;:&quot;agoracosmopolite.com&quot;,&quot;_2&quot;:104},{&quot;_1&quot;:&quot;wegovern.ca&quot;,&quot;_2&quot;:75},{&quot;_1&quot;:&quot;www.conservative.ca&quot;,&quot;_2&quot;:71},{&quot;_1&quot;:&quot;canadianactionparty.ca&quot;,&quot;_2&quot;:59}],&quot;genId&quot;:&quot;1205564234&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pieChart'], \n      function(playground, _magicpieChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpieChart,\n    \"o\": {\"series\":\"_1\",\"p\":\"_2\",\"nrow\":10,\"shown\":10,\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    </div>\n            </div></div>\n      </div></div>"},"output_type":"execute_result","execution_count":3}]},{"metadata":{},"cell_type":"markdown","source":"This extracts the plain text from a directory of ARCs/WARCs, or an individual WARC/ARC file."},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false},"cell_type":"code","source":"val r = \nRecordLoader.loadArc(\"/Users/ianmilligan1/Dropbox/warcs-workshop/227-20051007202637-00000-crawling018.arc.gz\",\nsc) \n.keepMimeTypes(Set(\"text/html\")) \n.discardDate(null) \n.map(r => { \nval t = ExtractRawText(r.getBodyContent) \nval len = 100 \n(r.getCrawldate, r.getUrl, if ( t.length > len ) t.substring(0, \nlen) else t)}) \n.collect() ","outputs":[{"name":"stdout","output_type":"stream","text":"r: Array[(String, String, String)] = Array((20051007,http://ndp.ca/robots.txt,302 Found Found The document has moved here. Apache/2.0.46 (Red Hat) Server at ndp.ca Port 80), (20051007,http://ndp.ca/,302 Found Found The document has moved here. Apache/2.0.46 (Red Hat) Server at ndp.ca Port 80), (20051007,http://www.ndp.ca/,NDP | The New Democratic Party of Canada ABOUT › Jack Layton › Our Caucus › Our History › Contact Us GET INVOLVED › Your Riding › Campaigns › Events › Youth RESOURCES › Press Room › Speeches & Articles › Downloads › e.NDP › More... SEARCH › Français  › NDP Budget Details › Jack's Budget Speech › Quotes on NDP Budget › Session in Review Privacy Policy | Jobs | RSS © 2005 New Democratic Party, all rights reserved. Authorized by the registered agent for Canada's NDP. prod..."},{"metadata":{},"data":{"text/html":"<div class=\"container-fluid\"><div><div class=\"col-md-12\"><div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon7a77862d89b57b53f4a37839f641e185&quot;,&quot;dataInit&quot;:[{&quot;_1&quot;:&quot;20051007&quot;,&quot;_2&quot;:&quot;http://ndp.ca/robots.txt&quot;,&quot;_3&quot;:&quot;302 Found Found The document has moved here. Apache/2.0.46 (Red Hat) Server at ndp.ca Port 80&quot;},{&quot;_1&quot;:&quot;20051007&quot;,&quot;_2&quot;:&quot;http://ndp.ca/&quot;,&quot;_3&quot;:&quot;302 Found Found The document has moved here. Apache/2.0.46 (Red Hat) Server at ndp.ca Port 80&quot;},{&quot;_1&quot;:&quot;20051007&quot;,&quot;_2&quot;:&quot;http://www.ndp.ca/&quot;,&quot;_3&quot;:&quot;NDP | The New Democratic Party of Canada ABOUT › Jack Layton › Our Caucus › Our History › Contact Us GET INVOLVED › Your Riding › Campaigns › Events › Youth RESOURCES › Press Room › Speeches &amp; Articles › Downloads › e.NDP › More... SEARCH › Français  › NDP Budget Details › Jack's Budget Speech › Quotes on NDP Budget › Session in Review Privacy Policy | Jobs | RSS © 2005 New Democratic Party, all rights reserved. Authorized by the registered agent for Canada's NDP. produced by : WEB NETWORKS Fri 7 Oct 2005 Jack Layton's speech to the CUPE Convention » Thu 6 Oct 2005 Layton Outlines Chaoulli Response Law To Protect Public Medicare » Thu 6 Oct 2005 Siksay To Volpe: Canadians Want Their Immigration Department To Serve Them, Not Celebrities » › more headlines&quot;}],&quot;genId&quot;:&quot;1056849122&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"_1\",\"_2\",\"_3\"],\"nrow\":3,\"shown\":3,\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    </div></div></div></div>"},"output_type":"execute_result","execution_count":6}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":true},"cell_type":"code","source":"","outputs":[]}],"nbformat":4}